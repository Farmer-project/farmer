etcd:
  container_name: farmer_proxy_etcd
  image: quay.io/coreos/etcd:v2.2.1
  ports:
    - 2380:2380
    - 2379:2379
  command:
    - -name=etcd
    - -data-dir=/var/etcd/data
    - -listen-client-urls=http://0.0.0.0:2379
    - -listen-peer-urls=http://0.0.0.0:2380
    - -advertise-client-urls=http://farmer_proxy_etcd:2379
  volumes:
    - /tmp/farmer-proxy-etcd:/var/etcd/data

registrator:
  container_name: farmer_proxy_registrator
  image: gliderlabs/registrator:v6
  command: -internal etcd://farmer_proxy_etcd:2379/services
  links:
    - etcd
  volumes:
    - "/var/run/docker.sock:/tmp/docker.sock"

proxy:
  container_name: farmer_proxy_server
  environment:
    ETCD_NODE: farmer_proxy_etcd:2379
  build: .
  links:
    - etcd
  ports:
    - 80:80

browser:
  container_name: farmer_proxy_etcd_browser
  image: etcd-browser
  ports:
    - 8000:8000
  links:
    - etcd
  environment:
    ETCD_HOST: farmer_proxy_etcd
    ETCD_PORT: 2379